{"version":3,"sources":["shaLua-compiled.js"],"names":[],"mappings":"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","file":"shaLua-compiled-compiled.js","sourcesContent":["/**\r\n * Created by wzhan039 on 2016-09-23.\r\n */\n/*\r\n*  把redis的Lua脚本sha化，存入内存\r\n*  单独一个文件，容易调试\r\n* */\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\n//sha单个Lua脚本\nvar shaSingleFile = function () {\n    var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(file) {\n        var content, sha;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n                switch (_context.prev = _context.next) {\n                    case 0:\n                        _context.next = 2;\n                        return asyncFs.asyncReadFile(file);\n\n                    case 2:\n                        content = _context.sent;\n                        _context.next = 5;\n                        return shaFileContent(content);\n\n                    case 5:\n                        sha = _context.sent;\n                        return _context.abrupt(\"return\", sha);\n\n                    case 7:\n                    case \"end\":\n                        return _context.stop();\n                }\n            }\n        }, _callee, this);\n    }));\n\n    return function shaSingleFile(_x) {\n        return _ref.apply(this, arguments);\n    };\n}();\n\n//sha文件或者目录\n\n\nvar shaLuaFileOrDir = function () {\n    var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(path) {\n        var allShaResult, singleShaResult, isDir, isFile, dirContent, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, singleFileDir, tmpFileDir, dirResult, key;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n                switch (_context2.prev = _context2.next) {\n                    case 0:\n                        allShaResult = {};\n                        singleShaResult = '';\n                        isDir = void 0, isFile = void 0;\n                        _context2.next = 5;\n                        return asyncFs.asyncIsDir(path);\n\n                    case 5:\n                        isDir = _context2.sent;\n\n                        if (!isDir) {\n                            _context2.next = 52;\n                            break;\n                        }\n\n                        _context2.next = 9;\n                        return asyncFs.asyncReadDir(path);\n\n                    case 9:\n                        dirContent = _context2.sent;\n                        _iteratorNormalCompletion = true;\n                        _didIteratorError = false;\n                        _iteratorError = undefined;\n                        _context2.prev = 13;\n                        _iterator = dirContent[Symbol.iterator]();\n\n                    case 15:\n                        if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                            _context2.next = 38;\n                            break;\n                        }\n\n                        singleFileDir = _step.value;\n\n                        //需要提供路径（目录+文件名）\n                        tmpFileDir = path + \"/\" + singleFileDir;\n                        _context2.next = 20;\n                        return asyncFs.asyncIsFile(tmpFileDir);\n\n                    case 20:\n                        isFile = _context2.sent;\n\n                        if (!isFile) {\n                            _context2.next = 27;\n                            break;\n                        }\n\n                        _context2.next = 24;\n                        return shaSingleFile(tmpFileDir);\n\n                    case 24:\n                        singleShaResult = _context2.sent;\n\n                        allShaResult[tmpFileDir] = singleShaResult;\n                        // console.log(tmpFileDir+':'+singleShaResult)\n                        return _context2.abrupt(\"continue\", 35);\n\n                    case 27:\n                        _context2.next = 29;\n                        return asyncFs.asyncIsDir(tmpFileDir);\n\n                    case 29:\n                        isDir = _context2.sent;\n\n                        if (!isDir) {\n                            _context2.next = 35;\n                            break;\n                        }\n\n                        _context2.next = 33;\n                        return shaLuaFileOrDir(tmpFileDir);\n\n                    case 33:\n                        dirResult = _context2.sent;\n\n                        for (key in dirResult) {\n                            allShaResult[key] = dirResult[key];\n                        }\n\n                    case 35:\n                        _iteratorNormalCompletion = true;\n                        _context2.next = 15;\n                        break;\n\n                    case 38:\n                        _context2.next = 44;\n                        break;\n\n                    case 40:\n                        _context2.prev = 40;\n                        _context2.t0 = _context2[\"catch\"](13);\n                        _didIteratorError = true;\n                        _iteratorError = _context2.t0;\n\n                    case 44:\n                        _context2.prev = 44;\n                        _context2.prev = 45;\n\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                            _iterator.return();\n                        }\n\n                    case 47:\n                        _context2.prev = 47;\n\n                        if (!_didIteratorError) {\n                            _context2.next = 50;\n                            break;\n                        }\n\n                        throw _iteratorError;\n\n                    case 50:\n                        return _context2.finish(47);\n\n                    case 51:\n                        return _context2.finish(44);\n\n                    case 52:\n                        return _context2.abrupt(\"return\", allShaResult);\n\n                    case 53:\n                    case \"end\":\n                        return _context2.stop();\n                }\n            }\n        }, _callee2, this, [[13, 40, 44, 52], [45,, 47, 51]]);\n    }));\n\n    return function shaLuaFileOrDir(_x2) {\n        return _ref2.apply(this, arguments);\n    };\n}();\n\n//执行指定的Lua脚本\n\n\nvar execLua = function () {\n    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3(fileOrDir, fileTobeExec, params) {\n        var shaResult, _loop, filePath, _ret;\n\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n            while (1) {\n                switch (_context3.prev = _context3.next) {\n                    case 0:\n                        _context3.next = 2;\n                        return shaLuaFileOrDir(fileOrDir);\n\n                    case 2:\n                        shaResult = _context3.sent;\n\n                        _loop = function _loop(filePath) {\n                            // console.log(filePath)\n                            if (-1 !== filePath.indexOf(fileTobeExec)) {\n\n                                return {\n                                    v: new Promise(function (reslove, reject) {\n                                        if (params) {\n                                            params = params.replace(regex.lua.paramsConvert, '$1$2');\n                                            /*                        console.log(typeof params)\r\n                                             console.log(params)*/\n                                        }\n                                        ioredisClient.evalsha(shaResult[filePath], 0, params, function (err, result) {\n\n                                            if (err) {\n                                                console.log(\"sha err is \" + err);reject(LuaError.LueExecFail(fileTobeExec));\n                                            }\n                                            console.log(\"sha result is \" + result);reslove(result);\n                                        });\n                                    })\n                                };\n                            }\n                        };\n\n                        _context3.t0 = regeneratorRuntime.keys(shaResult);\n\n                    case 5:\n                        if ((_context3.t1 = _context3.t0()).done) {\n                            _context3.next = 12;\n                            break;\n                        }\n\n                        filePath = _context3.t1.value;\n                        _ret = _loop(filePath);\n\n                        if (!((typeof _ret === \"undefined\" ? \"undefined\" : _typeof(_ret)) === \"object\")) {\n                            _context3.next = 10;\n                            break;\n                        }\n\n                        return _context3.abrupt(\"return\", _ret.v);\n\n                    case 10:\n                        _context3.next = 5;\n                        break;\n\n                    case 12:\n                        return _context3.abrupt(\"return\", shaResult);\n\n                    case 13:\n                    case \"end\":\n                        return _context3.stop();\n                }\n            }\n        }, _callee3, this);\n    }));\n\n    return function execLua(_x3, _x4, _x5) {\n        return _ref3.apply(this, arguments);\n    };\n}();\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nrequire(\"babel-polyfill\");\nrequire(\"babel-core/register\");\nvar asyncFs = require('../wrapAsync/node/wrapAsyncNode').asyncFs;\nvar ioredisError = require('../../define/error/redisError').redisError.cmdError;\nvar LuaError = require('../../define/error/redisError').redisError.LuaError;\nvar ioredisClient = require('../../model/redis/connection/redis_connection').ioredisClient;\nvar regex = require('../../define/regex/regex').regex;\n\n//将文件的 内容 sha化\nfunction shaFileContent(scriptContent) {\n    return new Promise(function (resolve, reject) {\n        ioredisClient.script('load', scriptContent, function (err, sha) {\n            if (err) {\n                reject(ioredisError.shaFail());\n            }\n            resolve(sha);\n        });\n    });\n}\n\nmodule.exports = {\n    shaSingleFile: shaSingleFile,\n    shaLuaFileOrDir: shaLuaFileOrDir,\n    execLua: execLua\n};\n\n//# sourceMappingURL=shaLua-compiled.js.map"]}