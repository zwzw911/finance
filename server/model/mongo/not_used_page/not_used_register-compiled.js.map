{"version":3,"sources":["not_used_register.js"],"names":[],"mappings":";;AAAA;;;;AAIA,IAAI,cAAY,QAAQ,gBAAR,CAAhB;AACA,IAAI,gBAAc,QAAQ,oCAAR,EAA8C,aAAhE;;AAEA,IAAI,YAAU,QAAQ,wCAAR,EAAkD,SAAhE;AACA,IAAI,gBAAc,QAAQ,wCAAR,EAAkD,aAApE;AACA,IAAI,aAAW,QAAQ,wCAAR,EAAkD,UAAjE;AACA,IAAI,YAAU,YAAY,SAA1B;;AAEA,IAAI,UAAQ,SAAR,OAAQ,CAAS,IAAT,EAAc,QAAd,EAAuB,WAAvB,EAAmC,QAAnC,EAA4C;AACpD,QAAI,OAAK,IAAI,SAAJ,EAAT;AACA,SAAK,IAAL,GAAU,IAAV;AACA,SAAK,QAAL,GAAc,QAAd;AACJ;AACI,QAAG,QAAM,WAAN,IAAqB,aAAW,WAAnC,EAA+C;AAC3C,aAAK,WAAL,GAAiB,WAAjB;AACH;;AAED,SAAK,KAAL,GAAW,IAAI,IAAJ,EAAX;;AAEA,eAAW,IAAX,CAAgB,IAAhB,EAAqB,UAArB,EAAgC,SAAhC,EAA0C,UAAS,WAAT,EAAqB,cAArB,EAAoC;AAClF;AACA;AACQ,YAAG,UAAQ,eAAe,MAA1B,EAAiC;AAC7B,mBAAO,SAAS,WAAT,EAAqB,cAArB,CAAP;AACH,SAFD,MAEK;AACb;AACY,sBAAU,KAAV,CAAgB,EAAC,QAAQ,IAAT,EAAhB,EAAgC,UAAU,GAAV,EAAe,MAAf,EAAuB;AACnD,oBAAI,GAAJ,EAAS;AACL,kCAAc,IAAI,IAAlB,EAAuB,IAAI,MAA3B,EAAkC,UAAlC,EAA6C,WAA7C;AACA,2BAAO,SAAS,GAAT,EAAa,EAAC,QAAO,KAAR,EAAc,SAAQ,cAAc,SAApC,EAAb,CAAP;AACA;AACH;AACjB;AACA;AACA;AACA;AACgB,oBAAG,SAAO,CAAV,EAAY;AACR,2BAAO,SAAS,IAAT,EAAc,EAAC,QAAO,KAAR,EAAc,SAAQ,UAAU,SAAV,CAAoB,KAA1C,EAAd,CAAP;AACA;AACH,iBAHD,MAGM;AACF,yBAAK,IAAL,CAAU,UAAS,GAAT,EAAa,SAAb,EAAuB,GAAvB,EAA2B;AACjC,4BAAI,GAAJ,EAAQ;AACJ,0CAAc,IAAI,IAAlB,EAAuB,IAAI,MAA3B,EAAkC,UAAlC,EAA6C,UAA7C;AACA,mCAAO,SAAS,GAAT,EAAa,EAAC,QAAO,KAAR,EAAc,SAAQ,cAAc,QAApC,EAAb,CAAP;AACH,yBAHD,MAGK;AAC7B;AAC4B,mCAAO,SAAS,IAAT,EAAc,EAAC,QAAO,IAAR,EAAa,SAAQ,UAAU,GAA/B,EAAd,CAAP;AACH;AACJ,qBARD;AASH;AACJ,aAxBD;AAyBH;AACJ,KAjCD;AAoCH,CA/CD;;AAiDA,QAAQ,OAAR,GAAgB,OAAhB","file":"not_used_register-compiled.js","sourcesContent":["/**\r\n * Created by wzhan039 on 2015-08-04.\r\n */\r\n\r\nvar dbStructure=require('./db_structure');\r\nvar errorRecorder=require('../express_component/recorderError').recorderError;\r\n\r\nvar userError=require('../assist/not_used_server_error_define').userError;\r\nvar mongooseError=require('../error_define/3rd_party_error_define').mongooseError;\r\nvar validateDb=require('../error_define/3rd_party_error_define').validateDb;\r\nvar userModel=dbStructure.userModel;\r\n\r\nvar addUser=function(name,password,mobilePhone,callback){\r\n    var user=new userModel();\r\n    user.name=name\r\n    user.password=password;\r\n//console.log(user)\r\n    if(null!=mobilePhone || undefined!=mobilePhone){\r\n        user.mobilePhone=mobilePhone;\r\n    }\r\n\r\n    user.cDate=new Date();\r\n\r\n    validateDb.user(user,'register','addUser',function(validateErr,validateResult){\r\n//console.log(validateErr)\r\n//console.log(validateResult)\r\n        if(false===validateResult.result){\r\n            return callback(validateErr,validateResult);\r\n        }else{\r\n//console.log(user)\r\n            userModel.count({'name': name}, function (err, result) {\r\n                if (err) {\r\n                    errorRecorder(err.code,err.errmsg,'register','countUser')\r\n                    return callback(err,{result:false,content:mongooseError.countUser})\r\n                    //return res.json(mongooseError.countUser)\r\n                }\r\n//console.log(result)\r\n//                if(null===result){\r\n//                    return callback(null,true)\r\n//                }\r\n                if(result>0){\r\n                    return callback(null,{result:false,content:userError.userExist.error})\r\n                    //return res.json({rc: 3, msg:\"用户名已存在\"})\r\n                } else{\r\n                    user.save(function(err,addedUser,num){\r\n                        if (err){\r\n                            errorRecorder(err.code,err.errmsg,'register','saveUser')\r\n                            return callback(err,{result:false,content:mongooseError.saveUser})\r\n                        }else{\r\n//console.log(addedUser)\r\n                            return callback(null,{result:true,content:addedUser._id})\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    })\r\n\r\n\r\n};\r\n\r\nexports.addUser=addUser;"]}