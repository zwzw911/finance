{"version":3,"sources":["generateClientRuleAttrQryerField.js"],"names":[],"mappings":"AAAA;;;;AAII;;AACJ,QAAQ,gBAAR;AACA,QAAQ,qBAAR;AACA,IAAI,gBAAc,QAAQ,sCAAR,CAAlB;AACA,IAAI,aAAW,QAAQ,yCAAR,EAAmD,SAAlE;AACA,IAAI,KAAG,QAAQ,IAAR,CAAP;;AAEA,IAAI,YAAU,EAAd;AACA,IAAI,kBAAgB,EAApB;AACA;;;AAIA,IAAI,QAAM,QAAQ,8BAAR,EAAwC,KAAlD;;AAEA;AACA,IAAI,kBAAgB;AAChB,UAAK,CAAC,MAAD,EAAQ,mBAAR,EAA4B,OAA5B,EAAoC,OAApC,EAA4C,OAA5C,CADW;AAEhB,gBAAW,CAAC,OAAD,EAAS,OAAT,EAAiB,OAAjB,CAFK;AAGhB,cAAS,CAAC,OAAD,EAAS,OAAT,EAAiB,OAAjB,CAHO;AAIhB,cAAS,CAAC,OAAD,EAAS,OAAT,EAAiB,OAAjB,CAJO;AAKhB,UAAK,CAAC,OAAD,EAAS,OAAT,EAAiB,OAAjB;AALW,CAApB;;AAQA;AACA,IAAI,kBAAgB;AAChB,UAAK,CAAC,MAAD,EAAQ,mBAAR,EAA4B,OAA5B,CADW;AAEhB,gBAAW,CAAC,OAAD,CAFK;AAGhB,cAAS,CAAC,OAAD,CAHO;AAIhB,cAAS,CAAC,OAAD,CAJO;AAKhB,UAAK,CAAC,OAAD;AALW,CAApB;;AAQA,IAAI,YAAU;AACV,gBAAW;AACP,0BAAiB;AADV,KADD;AAIV,cAAS;AACL,gBAAO;AADF,KAJC;AAQV,cAAS;AACL,wBAAe;AADV,KARC;AAWV,UAAK;AACD,kBAAS,eADR;AAED,oBAAW;AAFV;AAXK,CAAd;;AAiBA,cAAc,uBAAd,CAAsC,UAAtC,EAAiD,CAAjD,EAAmD,SAAnD;AACA,QAAQ,GAAR,CAAY,UAAU,YAAV,CAAZ;AACA,cAAc,qBAAd,CAAoC,SAApC,EAA8C,eAA9C;AACA,QAAQ,GAAR,CAAY,UAAU,YAAV,CAAZ;AACA,cAAc,mBAAd,CAAkC,SAAlC,EAA4C,SAA5C;AACA,QAAQ,GAAR,CAAY,UAAU,YAAV,CAAZ;AACA,GAAG,SAAH,CAAa,eAAb,EAA6B,KAAK,SAAL,CAAe,SAAf,CAA7B;;AAEA,kBAAgB,cAAc,kBAAd,EAAhB;AACA,cAAc,qBAAd,CAAoC,eAApC,EAAoD,eAApD;AACA,cAAc,mBAAd,CAAkC,eAAlC,EAAkD,SAAlD;AACA,GAAG,SAAH,CAAa,qBAAb,EAAmC,KAAK,SAAL,CAAe,eAAf,CAAnC;;AAGA;;;;AAIA;AACA;AACA;AACA;AACA,IAAI,iCAA+B,SAA/B,8BAA+B,CAAS,SAAT,EAAmB,SAAnB,EAA6B;AAC5D,QAAI,SAAO,EAAX;AACA,SAAI,IAAI,IAAR,IAAgB,SAAhB,EAA0B;AACtB,eAAO,IAAP,IAAa,EAAb;AACA,aAAI,IAAI,KAAR,IAAiB,UAAU,IAAV,CAAjB,EAAiC;AAC7B,gBAAI,YAAU,EAAd;AACA,sBAAU,OAAV,IAAmB,UAAU,IAAV,EAAgB,KAAhB,EAAuB,aAAvB,CAAnB;AACA,sBAAU,KAAV,IAAiB,KAAjB;AACA,sBAAU,MAAV,IAAkB,UAAU,IAAV,EAAgB,KAAhB,EAAuB,MAAvB,CAAlB;AACA,mBAAO,IAAP,EAAa,IAAb,CAAkB,SAAlB;AACH;AACJ;AACD,WAAO,MAAP;AACH,CAbD;AAcA,IAAI,SAAO,+BAA+B,SAA/B,EAAyC,UAAzC,CAAX;AACA;AACA,GAAG,SAAH,CAAa,gBAAb,EAA8B,KAAK,SAAL,CAAe,MAAf,CAA9B;;AAEA,QAAQ,GAAR,CAAY,MAAZ","file":"generateClientRuleAttrQryerField-compiled.js","sourcesContent":["/**\r\n * Created by wzhan039 on 2016-09-08.\r\n * dbstructure==>inputRule==>clientInputRule/clientInputAttr==>deleteNonNeededObject==>objectIdToRealField==>最终结果\r\n */\r\n    'use strict'\r\nrequire(\"babel-polyfill\");\r\nrequire(\"babel-core/register\")\r\nvar genClientFunc=require(\"../server/assist/genClientConfigFunc\")\r\nvar ruleDefine=require(\"../server/define/validateRule/inputRule\").inputRule\r\nvar fs=require('fs')\r\n\r\nvar inputAttr={}\r\nvar clientInputRule={}\r\n/*generateClientDefine(ruleDefine,2,inputAttr)\r\n console.log(inputAttr)*/\r\n\r\n\r\nvar regex=require('../server/define/regex/regex').regex\r\n\r\n//根据inputRule产生，不需要在客户端使用的字段\r\nvar skipListForRule={\r\n    user:['salt','encryptedPassword','cDate','uDate','dDate'],\r\n    department:['cDate','uDate','dDate'],\r\n    employee:['cDate','uDate','dDate'],\r\n    billType:['cDate','uDate','dDate'],\r\n    bill:['cDate','uDate','dDate'],\r\n}\r\n\r\n//attr只负责显示，不负责check input\r\nvar skipListForAttr={\r\n    user:['salt','encryptedPassword','dDate'],\r\n    department:['dDate'],\r\n    employee:['dDate'],\r\n    billType:['dDate'],\r\n    bill:['dDate'],\r\n}\r\n\r\nvar matchList={\r\n    department:{\r\n        parentDepartment:'department.name'\r\n    },\r\n    employee:{\r\n        leader:'employee.name',\r\n        //department:'department.name'\r\n    },\r\n    billType:{\r\n        parentBillType:'billType.name'\r\n    },\r\n    bill:{\r\n        billType:'billType.name',\r\n        reimburser:'employee.name'\r\n    }\r\n}\r\n\r\ngenClientFunc.generateClientInputAttr(ruleDefine,2,inputAttr)\r\nconsole.log(inputAttr['department'])\r\ngenClientFunc.deleteNonNeededObject(inputAttr,skipListForAttr)\r\nconsole.log(inputAttr['department'])\r\ngenClientFunc.objectIdToRealField(inputAttr,matchList)\r\nconsole.log(inputAttr['department'])\r\nfs.writeFile('inputAttr.txt',JSON.stringify(inputAttr))\r\n\r\nclientInputRule=genClientFunc.generateClientRule()\r\ngenClientFunc.deleteNonNeededObject(clientInputRule,skipListForRule)\r\ngenClientFunc.objectIdToRealField(clientInputRule,matchList)\r\nfs.writeFile('clientInputRule.txt',JSON.stringify(clientInputRule))\r\n\r\n\r\n/*              不直接使用inputAttr/inputRule，而是新建一个对象进行queryFiled的设置\r\n*       因为inputRule用来检测create/update，inputAttr用来存储create/update对应的值\r\n*       而queryField可能包含比inputRule/Attr更多的字段\r\n* */\r\n//从inputAttr提取出用于选择queryField的键值对（用于ng-select，ng-select接受格式为数组，每个元素包含key,value，key为显示在页面上，value用于存储选择的字段名称)\r\n//key\r\n//value\r\n//type\r\nvar extractQueryFieldFromInputAttr=function(inputAttr,inputRule){\r\n    let result={}\r\n    for(let coll in inputAttr){\r\n        result[coll]=[]\r\n        for(let field in inputAttr[coll]){\r\n            let tmpResult={}\r\n            tmpResult['value']=inputAttr[coll][field]['chineseName']\r\n            tmpResult['key']=field\r\n            tmpResult['type']=inputRule[coll][field]['type']\r\n            result[coll].push(tmpResult)\r\n        }\r\n    }\r\n    return result\r\n}\r\nvar result=extractQueryFieldFromInputAttr(inputAttr,ruleDefine)\r\n// console.log(result)\r\nfs.writeFile('queryField.txt',JSON.stringify(result))\r\n\r\nconsole.log('done')"]}